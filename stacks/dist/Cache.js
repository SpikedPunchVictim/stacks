"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Cache = void 0;
const UidKeeper_1 = require("./UidKeeper");
class Cache {
    constructor() {
        /**
         * Key: Model name
         * Value: Model
         */
        this.modelMap = new Map();
        /**
         * Key: Model Name
         * Value: Object
         */
        this.objects = new Map();
    }
    get models() {
        let results = new Array();
        for (let model of this.modelMap.values()) {
            results.push(model);
        }
        return results;
    }
    deleteModel(name) {
        this.modelMap.delete(name);
    }
    getModel(name) {
        return this.modelMap.get(name);
    }
    getModelById(id) {
        for (let model of this.modelMap.values()) {
            if (model.id === id) {
                return model;
            }
        }
        return undefined;
    }
    hasId(id) {
        let model = this.getModelById(id);
        if (model) {
            return true;
        }
        for (let [_, objects] of this.objects) {
            let found = objects.find(o => o.id === id);
            if (found) {
                return true;
            }
        }
        return false;
    }
    saveModel(model) {
        this.modelMap.set(model.name, model);
    }
    saveObject(model, obj) {
        if (obj.id === UidKeeper_1.UidKeeper.IdNotSet) {
            /*
               Objects must have IDs in order for them to be cached.
               We would have no way to look them up from the cache.
               This means that an Object can be created, before it is
               saved, and the get() calls will not work on them to
               find the Object.
            */
            throw new Error(`Cannot cache an Object without an ID`);
        }
        let objects = this.objects.get(model.name);
        if (objects === undefined) {
            objects = new Array();
            this.objects.set(model.name, objects);
        }
        let found = objects.findIndex(o => o.id === obj.id);
        if (found === -1) {
            objects.push(obj);
            return;
        }
        objects.splice(found, 1);
        objects.push(obj);
    }
    deleteObject(model, obj) {
        let objects = this.objects.get(model.name);
        if (objects === undefined) {
            return;
        }
        let found = objects.findIndex(o => o.id === obj.id);
        if (found === -1) {
            return;
        }
        objects.splice(found, 1);
    }
    getObject(model, id) {
        let objects = this.objects.get(model.name);
        if (objects === undefined) {
            return undefined;
        }
        return objects.find(o => o.id === id);
    }
    getObjects(model) {
        let objects = this.objects.get(model.name);
        return objects || new Array();
    }
}
exports.Cache = Cache;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2FjaGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvQ2FjaGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBRUEsMkNBQXdDO0FBNEV4QyxNQUFhLEtBQUs7SUF3QmY7UUFaQTs7O1dBR0c7UUFDSyxhQUFRLEdBQXdCLElBQUksR0FBRyxFQUFrQixDQUFBO1FBRWpFOzs7V0FHRztRQUNLLFlBQU8sR0FBd0IsSUFBSSxHQUFHLEVBQWlCLENBQUE7SUFJL0QsQ0FBQztJQXpCRCxJQUFJLE1BQU07UUFDUCxJQUFJLE9BQU8sR0FBRyxJQUFJLEtBQUssRUFBVSxDQUFBO1FBRWpDLEtBQUksSUFBSSxLQUFLLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsRUFBRTtZQUN0QyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFBO1NBQ3JCO1FBRUQsT0FBTyxPQUFPLENBQUE7SUFDakIsQ0FBQztJQW1CRCxXQUFXLENBQUMsSUFBWTtRQUNyQixJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUM3QixDQUFDO0lBRUQsUUFBUSxDQUFDLElBQVk7UUFDbEIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUNqQyxDQUFDO0lBRUQsWUFBWSxDQUFDLEVBQVU7UUFDcEIsS0FBSSxJQUFJLEtBQUssSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxFQUFFO1lBQ3RDLElBQUcsS0FBSyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUU7Z0JBQ2pCLE9BQU8sS0FBSyxDQUFBO2FBQ2Q7U0FDSDtRQUVELE9BQU8sU0FBUyxDQUFBO0lBQ25CLENBQUM7SUFFRCxLQUFLLENBQUMsRUFBVTtRQUNiLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsRUFBRSxDQUFDLENBQUE7UUFFakMsSUFBRyxLQUFLLEVBQUU7WUFDUCxP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QUNuQyxDQUFDO0NBQ0g7QUFoSUQsc0JBZ0lDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU3RhY2tPYmplY3QgfSBmcm9tIFwiLi9TdGFja09iamVjdFwiO1xuaW1wb3J0IHsgSU1vZGVsIH0gZnJvbSBcIi4vTW9kZWxcIjtcbmltcG9ydCB7IFVpZEtlZXBlciB9IGZyb20gXCIuL1VpZEtlZXBlclwiO1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgSUNhY2hlIHtcbiAgIC8qKlxuICAgICogR2V0cyBhIGxpc3Qgb2YgZGVmaW5lZCBNb2RlbHNcbiAgICAqL1xuICAgcmVhZG9ubHkgbW9kZWxzOiBJTW9kZWxbXVxuXG4gICAvKipcbiAgICAqIERlbGV0ZXMgYSBNb2RlbCBmcm9tIHRoZSBjYWNoZVxuICAgICogXG4gICAgKiBAcGFyYW0gbmFtZSBUaGUgTW9kZWwncyBuYW1lXG4gICAgKi9cbiAgIGRlbGV0ZU1vZGVsKG5hbWU6IHN0cmluZyk6IHZvaWRcblxuICAgLyoqXG4gICAgKiBHZXRzIGEgTW9kZWwgYnkgbmFtZVxuICAgICogXG4gICAgKiBAcGFyYW0gbmFtZSBUaGUgTW9kZWwncyBuYW1lXG4gICAgKi9cbiAgIGdldE1vZGVsKG5hbWU6IHN0cmluZyk6IElNb2RlbCB8IHVuZGVmaW5lZFxuXG4gICAvKipcbiAgICAqIEdldHMgYSBNb2RlbCBieSBJRFxuICAgICogXG4gICAgKiBAcGFyYW0gaWQgVGhlIE1vZGVsJ3MgSURcbiAgICAqL1xuICAgZ2V0TW9kZWxCeUlkKGlkOiBzdHJpbmcpOiBJTW9kZWwgfCB1bmRlZmluZWRcblxuICAgLyoqXG4gICAgKiBTZWFyY2hlcyB0aGUgQ2FjaGUgZm9yIGFuIElEXG4gICAgKiBcbiAgICAqIEBwYXJhbSBpZCBUaGUgSUQgdG8gc2VhcmNoIGZvclxuICAgICovXG4gICBoYXNJZChpZDogc3RyaW5nKTogYm9vbGVhblxuXG4gICAvKipcbiAgICAqIFN0b3JlcyBhIE1vZGVsIGluIHRoZSBjYWNoZVxuICAgICogXG4gICAgKiBAcGFyYW0gbW9kZWwgVGhlIE1vZGVsIHRvIHN0b3JlXG4gICAgKi9cbiAgIHNhdmVNb2RlbChtb2RlbDogSU1vZGVsKTogdm9pZFxuXG4gICAvKipcbiAgICAqIFN0b3JlcyBhbiBPYmplY3QgaW4gdGhlIGNhY2hlXG4gICAgKiBcbiAgICAqIEBwYXJhbSBtb2RlbCBUaGUgT2JqZWN0J3MgTW9kZWxcbiAgICAqIEBwYXJhbSBvYmogVGhlIE9iamVjdCB0byBTdG9yZS4gVGhpcyBpcyBhbiBQcm94eU9iamVjdFxuICAgICovXG4gICBzYXZlT2JqZWN0PFQgZXh0ZW5kcyBTdGFja09iamVjdD4obW9kZWw6IElNb2RlbCwgb2JqOiBUKTogdm9pZFxuXG4gICAvKipcbiAgICAqIERlbGV0ZXMgYW4gT2JqZWN0IGZyb20gdGhlIGNhY2hlXG4gICAgKiBcbiAgICAqIEBwYXJhbSBtb2RlbCBUaGUgT2JqZWN0J3MgTW9kZWxcbiAgICAqIEBwYXJhbSBvYmogVGhlIE9iamVjdCB0byBkZWxldGVcbiAgICAqL1xuICAgZGVsZXRlT2JqZWN0PFQgZXh0ZW5kcyBTdGFja09iamVjdD4obW9kZWw6IElNb2RlbCwgb2JqOiBUKTogdm9pZFxuXG4gICAvKipcbiAgICAqIEdldHMgYW4gT2JqZWN0IChQcm94eU9iamVjdCkgZnJvbSB0aGUgQ2FjaGVcbiAgICAqIFxuICAgICogQHBhcmFtIG1vZGVsIFRoZSBPYmplY3QncyBNb2RlbFxuICAgICogQHBhcmFtIGlkIFRoZSBPYmplY3QncyBJRFxuICAgICovXG4gICBnZXRPYmplY3Q8VCBleHRlbmRzIFN0YWNrT2JqZWN0Pihtb2RlbDogSU1vZGVsLCBpZDogc3RyaW5nKTogVCB8IHVuZGVmaW5lZFxuXG4gICAvKipcbiAgICAqIEdldHMgbWFueSBPYmplY3RzIChQcm94eU9iamVjdHMpIGZyb20gdGhlIGNhY2hlIGJhc2VkIG9uIHRoZSBNb2RlbFxuICAgICogXG4gICAgKiBAcGFyYW0gbW9kZWwgVGhlIE1vZGVsIG9mIHRoZSBPYmplY3RzXG4gICAgKi9cbiAgIGdldE9iamVjdHM8VCBleHRlbmRzIFN0YWNrT2JqZWN0Pihtb2RlbDogSU1vZGVsKTogVFtdXG59XG5cbmV4cG9ydCBjbGFzcyBDYWNoZSBpbXBsZW1lbnRzIElDYWNoZSB7XG4gICBnZXQgbW9kZWxzKCk6IElNb2RlbFtdIHtcbiAgICAgIGxldCByZXN1bHRzID0gbmV3IEFycmF5PElNb2RlbD4oKVxuXG4gICAgICBmb3IobGV0IG1vZGVsIG9mIHRoaXMubW9kZWxNYXAudmFsdWVzKCkpIHtcbiAgICAgICAgIHJlc3VsdHMucHVzaChtb2RlbClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHJlc3VsdHNcbiAgIH1cblxuXG4gICAvKipcbiAgICAqIEtleTogTW9kZWwgbmFtZVxuICAgICogVmFsdWU6IE1vZGVsXG4gICAgKi9cbiAgIHByaXZhdGUgbW9kZWxNYXA6IE1hcDxzdHJpbmcsIElNb2RlbD4gPSBuZXcgTWFwPHN0cmluZywgSU1vZGVsPigpXG5cbiAgIC8qKlxuICAgICogS2V5OiBNb2RlbCBOYW1lXG4gICAgKiBWYWx1ZTogT2JqZWN0XG4gICAgKi9cbiAgIHByaXZhdGUgb2JqZWN0czogTWFwPHN0cmluZywgYW55W10+ID0gIG5ldyBNYXA8c3RyaW5nLCBhbnlbXT4oKVxuXG4gICBjb25zdHJ1Y3RvcigpIHtcblxuICAgfVxuXG4gICBkZWxldGVNb2RlbChuYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgIHRoaXMubW9kZWxNYXAuZGVsZXRlKG5hbWUpXG4gICB9XG5cbiAgIGdldE1vZGVsKG5hbWU6IHN0cmluZyk6IElNb2RlbCB8IHVuZGVmaW5lZCB7XG4gICAgICByZXR1cm4gdGhpcy5tb2RlbE1hcC5nZXQobmFtZSlcbiAgIH1cblxuICAgZ2V0TW9kZWxCeUlkKGlkOiBzdHJpbmcpOiBJTW9kZWwgfCB1bmRlZmluZWQge1xuICAgICAgZm9yKGxldCBtb2RlbCBvZiB0aGlzLm1vZGVsTWFwLnZhbHVlcygpKSB7XG4gICAgICAgICBpZihtb2RlbC5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgIHJldHVybiBtb2RlbFxuICAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdW5kZWZpbmVkXG4gICB9XG5cbiAgIGhhc0lkKGlkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgIGxldCBtb2RlbCA9IHRoaXMuZ2V0TW9kZWxCeUlkKGlkKVxuXG4gICAgICBpZihtb2RlbCkge1xuICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cblxuICAgICAgZm9yKGxldCBbXywgb2JqZWN0c10gb2YgdGhpcy5vYmplY3RzKSB7XG4gICAgICAgICBsZXQgZm91bmQgPSBvYmplY3RzLmZpbmQobyA9PiBvLmlkID09PSBpZClcblxuICAgICAgICAgaWYoZm91bmQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZVxuICAgfVxuXG4gICBzYXZlTW9kZWwobW9kZWw6IElNb2RlbCk6IHZvaWQge1xuICAgICAgdGhpcy5tb2RlbE1hcC5zZXQobW9kZWwubmFtZSwgbW9kZWwpXG4gICB9XG4gICBcbiAgIHNhdmVPYmplY3Q8VCBleHRlbmRzIFN0YWNrT2JqZWN0Pihtb2RlbDogSU1vZGVsLCBvYmo6IFQpOiB2b2lkIHtcbiAgICAgIGlmKG9iai5pZCA9PT0gVWlkS2VlcGVyLklkTm90U2V0KSB7XG4gICAgICAgICAvKlxuICAgICAgICAgICAgT2JqZWN0cyBtdXN0IGhhdmUgSURzIGluIG9yZGVyIGZvciB0aGVtIHRvIGJlIGNhY2hlZC5cbiAgICAgICAgICAgIFdlIHdvdWxkIGhhdmUgbm8gd2F5IHRvIGxvb2sgdGhlbSB1cCBmcm9tIHRoZSBjYWNoZS5cbiAgICAgICAgICAgIFRoaXMgbWVhbnMgdGhhdCBhbiBPYmplY3QgY2FuIGJlIGNyZWF0ZWQsIGJlZm9yZSBpdCBpc1xuICAgICAgICAgICAgc2F2ZWQsIGFuZCB0aGUgZ2V0KCkgY2FsbHMgd2lsbCBub3Qgd29yayBvbiB0aGVtIHRvXG4gICAgICAgICAgICBmaW5kIHRoZSBPYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgY2FjaGUgYW4gT2JqZWN0IHdpdGhvdXQgYW4gSURgKVxuICAgICAgfVxuXG4gICAgICBsZXQgb2JqZWN0cyA9IHRoaXMub2JqZWN0cy5nZXQobW9kZWwubmFtZSlcblxuICAgICAgaWYob2JqZWN0cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICBvYmplY3RzID0gbmV3IEFycmF5PGFueT4oKVxuICAgICAgICAgdGhpcy5vYmplY3RzLnNldChtb2RlbC5uYW1lLCBvYmplY3RzKVxuICAgICAgfVxuXG4gICAgICBsZXQgZm91bmQgPSBvYmplY3RzLmZpbmRJbmRleChvID0+IG8uaWQgPT09IG9iai5pZClcblxuICAgICAgaWYoZm91bmQgPT09IC0xKSB7XG4gICAgICAgICBvYmplY3RzLnB1c2gob2JqKVxuICAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIG9iamVjdHMuc3BsaWNlKGZvdW5kLCAxKVxuICAgICAgb2JqZWN0cy5wdXNoKG9iailcbiAgIH1cblxuICAgZGVsZXRlT2JqZWN0PFQgZXh0ZW5kcyBTdGFja09iamVjdD4obW9kZWw6IElNb2RlbCwgb2JqOiBUKTogdm9pZCB7XG4gICAgICBsZXQgb2JqZWN0cyA9IHRoaXMub2JqZWN0cy5nZXQobW9kZWwubmFtZSlcblxuICAgICAgaWYob2JqZWN0cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgbGV0IGZvdW5kID0gb2JqZWN0cy5maW5kSW5kZXgobyA9PiBvLmlkID09PSBvYmouaWQpXG5cbiAgICAgIGlmKGZvdW5kID09PSAtMSkge1xuICAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIG9iamVjdHMuc3BsaWNlKGZvdW5kLCAxKVxuICAgfVxuXG4gICBnZXRPYmplY3Q8VCBleHRlbmRzIFN0YWNrT2JqZWN0Pihtb2RlbDogSU1vZGVsLCBpZDogc3RyaW5nKTogVCB8IHVuZGVmaW5lZCB7XG4gICAgICBsZXQgb2JqZWN0cyA9IHRoaXMub2JqZWN0cy5nZXQobW9kZWwubmFtZSlcblxuICAgICAgaWYob2JqZWN0cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICByZXR1cm4gdW5kZWZpbmVkXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvYmplY3RzLmZpbmQobyA9PiBvLmlkID09PSBpZClcbiAgIH1cblxuICAgZ2V0T2JqZWN0czxUIGV4dGVuZHMgU3RhY2tPYmplY3Q+KG1vZGVsOiBJTW9kZWwpOiBUW10ge1xuICAgICAgbGV0IG9iamVjdHMgPSB0aGlzLm9iamVjdHMuZ2V0KG1vZGVsLm5hbWUpXG4gICAgICByZXR1cm4gb2JqZWN0cyB8fCBuZXcgQXJyYXk8VD4oKVxuICAgfVxufSJdfQ==