"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const _1 = require(".");
async function main() {
    let stack = _1.Stack.create();
    let ReferenceType = await stack.create.model('reference', {
        string: 'use me',
        items: [0, 1, 2, 3, 4]
    });
    let GG = await stack.create.model('gg', {
        name: {
            type: ({ string }) => string,
            value: '',
            symbols: [
                { name: 'no-re', value: { some: 'thing', is: -1, not: { anything: true } } }
            ]
        },
        int: -42,
        uint: ({ uint }) => uint(42),
        bool: false,
        list: [''],
        ref: ({ ref }) => ref(ReferenceType.name),
        string: 'Oh man!'
    });
    let ggs = new Array();
    for (let i = 0; i < 99; ++i) {
        let created = await GG.create();
        await GG.save(created);
        ggs.push(created);
    }
    let paged = await GG.getAll();
    console.dir(paged);
    let Team = await stack.create.model('team', {
        name: '',
        manager: 'mother'
    });
    let defaultTeam = await Team.create({
        name: 'default',
        manager: 'jefe'
    });
    let User = await stack.create.model('user', {
        name: '',
        age: 0,
        money: -100,
        team: ({ ref }) => ref('team', defaultTeam.id)
    });
    let chris = await User.create({
        name: 'chris'
    });
    stack.update.object(User, chris, async (obj, state) => {
        if (state === _1.ExistState.DoesNotExist) {
            return;
        }
        obj.age = 34;
    });
    /*
       type StoreContext = {
          name: string      // The data store name (ie stacks:dynamo)
          version: string   // The data store version
          store: any
       }
 
       stack.setQuery(async (context: StoreContext) => {
          let query = new CustomQueryObject(context)
       })
    */
    console.dir(chris, { depth: null });
}
main()
    .then(() => {
    console.log(`Succeeded`);
    process.exit(0);
})
    .catch(err => {
    console.error(`Failed`);
    console.error(`Reason:\n${err}\nStack:\n${err.stack}`);
    process.exit(1);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy90ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsd0JBQWtEO0FBRWxELEtBQUssVUFBVSxJQUFJO0lBQ2hCLElBQUksS0FBSyxHQUFHLFFBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQTtJQWMxQixJQUFJLGFBQWEsR0FBRyxNQUFNLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBRTtRQUN2RCxNQUFNLEVBQUUsUUFBUTtRQUNoQixLQUFLLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0tBQ3hCLENBQUMsQ0FBQTtJQUVGLElBQUksRUFBRSxHQUFHLE1BQU0sS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFO1FBQ3JDLElBQUksRUFBRTtZQUNILElBQUksRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxDQUFDLE1BQU07WUFDNUIsS0FBSyxFQUFFLEVBQUU7WUFDVCxPQUFPLEVBQUU7Z0JBQ04sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFO2FBQzlFO1NBQ0g7UUFDRCxHQUFHLEVBQUUsQ0FBQyxFQUFFO1FBQ1IsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUM1QixJQUFJLEVBQUUsS0FBSztRQUNYLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQztRQUNWLEdBQUcsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDO1FBQ3pDLE1BQU0sRUFBRSxTQUFTO0tBQ25CLENBQUMsQ0FBQTtJQUVGLElBQUksR0FBRyxHQUFHLElBQUksS0FBSyxFQUFlLENBQUE7SUFFbEMsS0FBSSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDO1FBQzFCLElBQUksT0FBTyxHQUFHLE1BQU0sRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFBO1FBQy9CLE1BQU0sRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUN0QixHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3BCLENBQUM7SUFFRCxJQUFJLEtBQUssR0FBRyxNQUFNLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQTtJQUU3QixPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFBO0lBRWxCLElBQUksSUFBSSxHQUFHLE1BQU0sS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFO1FBQ3pDLElBQUksRUFBRSxFQUFFO1FBQ1IsT0FBTyxFQUFFLFFBQVE7S0FDbkIsQ0FBQyxDQUFBO0lBRUYsSUFBSSxXQUFXLEdBQUcsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFXO1FBQzNDLElBQUksRUFBRSxTQUFTO1FBQ2YsT0FBTyxFQUFFLE1BQU07S0FDakIsQ0FBQyxDQUFBO0lBRUYsSUFBSSxJQUFJLEdBQUcsTUFBTSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUU7UUFDekMsSUFBSSxFQUFFLEVBQUU7UUFDUixHQUFHLEVBQUUsQ0FBQztRQUNOLEtBQUssRUFBRSxDQUFDLEdBQUc7UUFDWCxJQUFJLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLFdBQVcsQ0FBQyxFQUFFLENBQUM7S0FDaEQsQ0FBQyxDQUFBO0lBRUYsSUFBSSxLQUFLLEdBQUcsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFXO1FBQ3JDLElBQUksRUFBRSxPQUFPO0tBQ2YsQ0FBQyxDQUFBO0lBRUYsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFO1FBQ25ELElBQUcsS0FBSyxLQUFLLGFBQVUsQ0FBQyxZQUFZLEVBQUUsQ0FBQztZQUNwQyxPQUFNO1FBQ1QsQ0FBQztRQUVELEdBQUksQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFBO0lBQ2hCLENBQUMsQ0FBQyxDQUFBO0lBRUY7Ozs7Ozs7Ozs7TUFVRTtJQUVGLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUE7QUFDdEMsQ0FBQztBQUVELElBQUksRUFBRTtLQUNGLElBQUksQ0FBQyxHQUFHLEVBQUU7SUFDUixPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFBO0lBQ3hCLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDbEIsQ0FBQyxDQUFDO0tBQ0QsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFO0lBQ1YsT0FBTyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQTtJQUN2QixPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksR0FBRyxhQUFhLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFBO0lBQ3RELE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDbEIsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFeGlzdFN0YXRlLCBTdGFjaywgU3RhY2tPYmplY3QgfSBmcm9tICcuJ1xuXG5hc3luYyBmdW5jdGlvbiBtYWluKCk6IFByb21pc2U8dm9pZD4ge1xuICAgbGV0IHN0YWNrID0gU3RhY2suY3JlYXRlKClcblxuICAgdHlwZSBVc2VyVHlwZSA9IHtcbiAgICAgIG5hbWU6IHN0cmluZ1xuICAgICAgYWdlOiBudW1iZXJcbiAgICAgIG1vbmV5OiBudW1iZXJcbiAgICAgIHRlYW06IFRlYW1UeXBlXG4gICB9ICYgU3RhY2tPYmplY3RcblxuICAgdHlwZSBUZWFtVHlwZSA9IHtcbiAgICAgIG5hbWU6IHN0cmluZ1xuICAgICAgbWFuYWdlcjogc3RyaW5nXG4gICB9ICYgU3RhY2tPYmplY3RcblxuICAgbGV0IFJlZmVyZW5jZVR5cGUgPSBhd2FpdCBzdGFjay5jcmVhdGUubW9kZWwoJ3JlZmVyZW5jZScsIHtcbiAgICAgIHN0cmluZzogJ3VzZSBtZScsXG4gICAgICBpdGVtczogWzAsIDEsIDIsIDMsIDRdXG4gICB9KVxuXG4gICBsZXQgR0cgPSBhd2FpdCBzdGFjay5jcmVhdGUubW9kZWwoJ2dnJywge1xuICAgICAgbmFtZToge1xuICAgICAgICAgdHlwZTogKHsgc3RyaW5nIH0pID0+IHN0cmluZyxcbiAgICAgICAgIHZhbHVlOiAnJyxcbiAgICAgICAgIHN5bWJvbHM6IFtcbiAgICAgICAgICAgIHsgbmFtZTogJ25vLXJlJywgdmFsdWU6IHsgc29tZTogJ3RoaW5nJywgaXM6IC0xLCBub3Q6IHsgYW55dGhpbmc6IHRydWUgfSB9IH1cbiAgICAgICAgIF1cbiAgICAgIH0sXG4gICAgICBpbnQ6IC00MixcbiAgICAgIHVpbnQ6ICh7IHVpbnQgfSkgPT4gdWludCg0MiksXG4gICAgICBib29sOiBmYWxzZSxcbiAgICAgIGxpc3Q6IFsnJ10sXG4gICAgICByZWY6ICh7IHJlZiB9KSA9PiByZWYoUmVmZXJlbmNlVHlwZS5uYW1lKSxcbiAgICAgIHN0cmluZzogJ09oIG1hbiEnXG4gICB9KVxuXG4gICBsZXQgZ2dzID0gbmV3IEFycmF5PFN0YWNrT2JqZWN0PigpXG5cbiAgIGZvcihsZXQgaSA9IDA7IGkgPCA5OTsgKytpKSB7XG4gICAgICBsZXQgY3JlYXRlZCA9IGF3YWl0IEdHLmNyZWF0ZSgpXG4gICAgICBhd2FpdCBHRy5zYXZlKGNyZWF0ZWQpXG4gICAgICBnZ3MucHVzaChjcmVhdGVkKVxuICAgfVxuXG4gICBsZXQgcGFnZWQgPSBhd2FpdCBHRy5nZXRBbGwoKVxuXG4gICBjb25zb2xlLmRpcihwYWdlZClcblxuICAgbGV0IFRlYW0gPSBhd2FpdCBzdGFjay5jcmVhdGUubW9kZWwoJ3RlYW0nLCB7XG4gICAgICBuYW1lOiAnJyxcbiAgICAgIG1hbmFnZXI6ICdtb3RoZXInXG4gICB9KVxuXG4gICBsZXQgZGVmYXVsdFRlYW0gPSBhd2FpdCBUZWFtLmNyZWF0ZTxUZWFtVHlwZT4oe1xuICAgICAgbmFtZTogJ2RlZmF1bHQnLFxuICAgICAgbWFuYWdlcjogJ2plZmUnXG4gICB9KVxuXG4gICBsZXQgVXNlciA9IGF3YWl0IHN0YWNrLmNyZWF0ZS5tb2RlbCgndXNlcicsIHtcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgYWdlOiAwLFxuICAgICAgbW9uZXk6IC0xMDAsXG4gICAgICB0ZWFtOiAoeyByZWYgfSkgPT4gcmVmKCd0ZWFtJywgZGVmYXVsdFRlYW0uaWQpXG4gICB9KVxuXG4gICBsZXQgY2hyaXMgPSBhd2FpdCBVc2VyLmNyZWF0ZTxVc2VyVHlwZT4oe1xuICAgICAgbmFtZTogJ2NocmlzJ1xuICAgfSlcblxuICAgc3RhY2sudXBkYXRlLm9iamVjdChVc2VyLCBjaHJpcywgYXN5bmMgKG9iaiwgc3RhdGUpID0+IHtcbiAgICAgIGlmKHN0YXRlID09PSBFeGlzdFN0YXRlLkRvZXNOb3RFeGlzdCkge1xuICAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIG9iaiEuYWdlID0gMzRcbiAgIH0pXG5cbiAgIC8qXG4gICAgICB0eXBlIFN0b3JlQ29udGV4dCA9IHtcbiAgICAgICAgIG5hbWU6IHN0cmluZyAgICAgIC8vIFRoZSBkYXRhIHN0b3JlIG5hbWUgKGllIHN0YWNrczpkeW5hbW8pXG4gICAgICAgICB2ZXJzaW9uOiBzdHJpbmcgICAvLyBUaGUgZGF0YSBzdG9yZSB2ZXJzaW9uXG4gICAgICAgICBzdG9yZTogYW55XG4gICAgICB9XG5cbiAgICAgIHN0YWNrLnNldFF1ZXJ5KGFzeW5jIChjb250ZXh0OiBTdG9yZUNvbnRleHQpID0+IHtcbiAgICAgICAgIGxldCBxdWVyeSA9IG5ldyBDdXN0b21RdWVyeU9iamVjdChjb250ZXh0KVxuICAgICAgfSlcbiAgICovXG5cbiAgIGNvbnNvbGUuZGlyKGNocmlzLCB7IGRlcHRoOiBudWxsIH0pXG59XG5cbm1haW4oKVxuICAgLnRoZW4oKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coYFN1Y2NlZWRlZGApXG4gICAgICBwcm9jZXNzLmV4aXQoMClcbiAgIH0pXG4gICAuY2F0Y2goZXJyID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZGApXG4gICAgICBjb25zb2xlLmVycm9yKGBSZWFzb246XFxuJHtlcnJ9XFxuU3RhY2s6XFxuJHtlcnIuc3RhY2t9YClcbiAgICAgIHByb2Nlc3MuZXhpdCgxKVxuICAgfSkiXX0=